{"ast":null,"code":"import * as React from 'react';\nimport { useGridApiMethod } from '../utils/useGridApiMethod';\nimport { GridSignature } from '../utils/useGridApiEventHandler';\nimport { EventManager } from '../../utils/EventManager';\n\nvar isSyntheticEvent = function isSyntheticEvent(event) {\n  return event.isPropagationStopped !== undefined;\n};\n\nvar globalId = 0;\nexport function useGridApiInitialization(inputApiRef, props) {\n  var apiRef = React.useRef();\n\n  if (!apiRef.current) {\n    apiRef.current = {\n      unstable_eventManager: new EventManager(),\n      unstable_caches: {},\n      state: {},\n      instanceId: globalId\n    };\n    globalId += 1;\n  }\n\n  React.useImperativeHandle(inputApiRef, function () {\n    return apiRef.current;\n  }, [apiRef]);\n  var publishEvent = React.useCallback(function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    var name = args[0],\n        params = args[1],\n        _args$ = args[2],\n        event = _args$ === void 0 ? {} : _args$;\n    event.defaultMuiPrevented = false;\n\n    if (isSyntheticEvent(event) && event.isPropagationStopped()) {\n      return;\n    }\n\n    var details = props.signature === GridSignature.DataGridPro ? {\n      api: apiRef.current\n    } : {};\n    apiRef.current.unstable_eventManager.emit(name, params, event, details);\n  }, [apiRef, props.signature]);\n  var subscribeEvent = React.useCallback(function (event, handler, options) {\n    apiRef.current.unstable_eventManager.on(event, handler, options);\n    var api = apiRef.current;\n    return function () {\n      api.unstable_eventManager.removeListener(event, handler);\n    };\n  }, [apiRef]);\n  var showError = React.useCallback(function (args) {\n    apiRef.current.publishEvent('componentError', args);\n  }, [apiRef]);\n  useGridApiMethod(apiRef, {\n    subscribeEvent: subscribeEvent,\n    publishEvent: publishEvent,\n    showError: showError\n  }, 'GridCoreApi');\n  React.useEffect(function () {\n    var api = apiRef.current;\n    return function () {\n      api.publishEvent('unmount');\n    };\n  }, [apiRef]);\n  return apiRef;\n}","map":null,"metadata":{},"sourceType":"module"}